function getURLVar(t){var e=[],c=document.location.search.split("?");if(c[1]){var o=c[1].split("&");for(i=0;i<o.length;i++){var r=o[i].split("=");r[0]&&r[1]&&(e[r[0]]=r[1])}return e[t]?e[t]:""}}$(document).ready(function(){var c;c=0,$(".catmenu .name").each(function(t,e){c<$(e).height()&&(c=$(e).height())}),$(".catmenu .name").each(function(t,e){$(e).height(c)}),$("#mob-menu .has-children").on("click",function(t){t.preventDefault(),$(this).hasClass("opened")?$(this).siblings(".subcat").removeClass("show"):$(this).siblings(".subcat").addClass("show"),$(this).toggleClass("opened")}),$(".price-sort").click(function(){var t=window.location,e=t.origin+t.pathname,c="",c="price"===getURLVar("sort")?"?sort=-price":"?sort=price";window.location.href=e+c+"#wrapper"}),$(".delivery-sort").click(function(){var t=window.location,e=t.origin+t.pathname,c="",c="delivery"===getURLVar("sort")?"?sort=-delivery":"?sort=delivery";window.location.href=e+c+"#wrapper"}),$("#search input").on("keydown",function(t){13==t.keyCode&&$("#search i").trigger("click")}),$("#search i").click(function(){$("#search").addClass("active");var t=$("#search input").val();t?(url=$("base").attr("href")+"index.php?route=product/search&search="+encodeURIComponent(t),location=url):$("#search").find("input").focus()});var t=location.href;$.each($("a"),function(){$(this).attr("href")==t&&$(this).addClass("active")});var e=$("#header"),o=$(e).outerHeight();$(e).find("#logo").after('<ul class="menu"><li class="is-submenu flyblock-parent">'+$(".menu li:first-child").html()+"</li></ul>"),$(window).scroll(function(){240<$(this).scrollTop()?($("body").css({"padding-top":o}),$(e).addClass("fixed")):($("body").css({"padding-top":0}),$(e).removeClass("fixed"))}),$("#grid-view").click(function(){$("#display *").attr("class",""),$(this).attr("class","active"),$("#content .product-list, #content .product-list2").attr("class","product-grid"),localStorage.setItem("display","grid")}),$("#list-view").click(function(){$("#display *").attr("class",""),$(this).attr("class","active"),$("#content .product-grid, #content .product-list2").attr("class","product-list"),localStorage.setItem("display","list")}),$("#list-view2").click(function(){$("#display *").attr("class",""),$(this).attr("class","active"),$("#content .product-grid, #content .product-list").attr("class","product-list2"),localStorage.setItem("display","list2")}),"list"==localStorage.getItem("display")?$("#list-view").trigger("click").attr("class","active"):"list2"==localStorage.getItem("display")?$("#list-view2").trigger("click").attr("class","active"):$("#grid-view").trigger("click").attr("class","active"),$(".mobile-arrow").click(function(){$(this).toggleClass("krest").next().toggle(320,function(){})}),$(".htabs").length&&$(".htabs").each(function(t,e){var c=$(this).find("a");$(c).each(function(){var t=$(this);$(t.attr("href")).hide(),t.click(function(){return $(c).removeClass("selected"),$(this).addClass("selected"),$($(this).attr("href")).fadeIn(),$(c).not(this).each(function(t,e){$($(e).attr("href")).hide()}),!1})}),$(c).first().click()}),$(window).width()<682&&$(".flyblock-parent").click(function(){$(this).find(".flyblock").toggle("slow")}),$("footer").prepend('<div id="scrollup">Запчасти для грузовых автомобилей с доставкой по России - ST-Spares.ru</div>'),$("footer").prepend('<a href="javascript:" id="return-to-top"><i>&#8593;</i></a>'),$(window).scroll(function(){50<=$(this).scrollTop()?$("#return-to-top").fadeIn(200):$("#return-to-top").fadeOut(200)}),$("#return-to-top").click(function(){$("body,html").animate({scrollTop:0},500)}),$("#cart").click(function(){$("#fastblock").html($("#flycart").html()),ShowImage(),$("#fastblock > div").attr("class","right")}),$(document).on("click","#flycart-content .qu-minus",function(){var t=$(this).next("input"),e=parseInt(t.val()),c=t.data("key");1<e?(t.val(e-1),cart.update(c,e-1,0)):cart.remove(c)}),$(document).on("click","#flycart-content .qu-plus",function(){var t=$(this).prev("input"),e=parseInt(t.val()),c=t.data("key");t.val(e+1),cart.update(c,e+1,0)}),$(document).on("click","#button-cart",function(){$.ajax({url:"index.php?route=checkout/cart/add",type:"post",data:$("#product input[type='text'], #product input[type='hidden'], #product input[type='radio']:checked, #product input[type='checkbox']:checked, #product select, #product textarea"),dataType:"json",beforeSend:function(){},complete:function(){},success:function(t){if($(".alert, .text-danger").remove(),t.error){if(t.error.option)for(i in t.error.option)$("#input-option"+i.replace("_","-")).append('<div class="text-danger">'+t.error.option[i]+"</div>");t.error.recurring&&$("select[name='recurring_id']").after('<div class="text-danger">'+t.error.recurring+"</div>")}t.success&&$("#cart").load("index.php?route=common/cart/info #cart > *",function(){$("#fastblock").html($("#flycart").html()),ShowImage(),$("#fastblock > div").attr("class","right")})},error:function(t,e,c){alert(c+"\r\n"+t.statusText+"\r\n"+t.responseText)}})}),$(document).on("click",".button-cart-analog",function(){var t=$("#product input[type='hidden']").val(),e=$(this).parents("tr").data("id"),c=$(this).parents("form").find("input").val(),o=$(this).parents("tr").data("price"),r=$(this).parents("tr").data("name");$.ajax({url:"index.php?route=checkout/cart/add",type:"post",data:{product_id:t,analog_id:e,quantity:c,name:r,price:o},dataType:"json",beforeSend:function(){},complete:function(){},success:function(t){if($(".alert, .text-danger").remove(),t.error){if(t.error.option)for(i in t.error.option)$("#input-option"+i.replace("_","-")).append('<div class="text-danger">'+t.error.option[i]+"</div>");t.error.recurring&&$("select[name='recurring_id']").after('<div class="text-danger">'+t.error.recurring+"</div>")}t.success&&$("#cart").load("index.php?route=common/cart/info #cart > *",function(){$("#fastblock").html($("#flycart").html()),ShowImage(),$("#fastblock > div").attr("class","right")})}})})});var cart={add:function(t,e){$.ajax({url:"index.php?route=checkout/cart/add",type:"post",data:"product_id="+t+"&quantity="+(void 0!==e?e:1),dataType:"json",beforeSend:function(){},complete:function(){},success:function(t){t.redirect&&(location=t.redirect),t.success&&$("#cart").load("index.php?route=common/cart/info #cart > *",function(){$("#fastblock").html($("#flycart").html()),ShowImage(),$("#fastblock > div").attr("class","right")})},error:function(t,e,c){alert(c+"\r\n"+t.statusText+"\r\n"+t.responseText)}})},update:function(t,e,c){$.ajax({url:"index.php?route=checkout/cart/edit",type:"post",data:"key="+t+"&quantity="+(void 0!==e?e:1)+(void 0!==c?"&isarray=0":""),dataType:"json",beforeSend:function(){},complete:function(){},success:function(t){"checkout/buy"==getURLVar("route")||"checkout/checkout"==getURLVar("route")?location="index.php?route=checkout/buy":$("#cart").load("index.php?route=common/cart/info #cart > *",function(){$("#fastblock > div").html($("#flycart").html()+'<i class="close x"></i>')})},error:function(t,e,c){alert(c+"\r\n"+t.statusText+"\r\n"+t.responseText)}})},remove:function(t){$.ajax({url:"index.php?route=checkout/cart/remove",type:"post",data:"key="+t,dataType:"json",beforeSend:function(){},complete:function(){},success:function(t){"checkout/buy"==getURLVar("route")||"checkout/checkout"==getURLVar("route")?location="index.php?route=checkout/buy":$("#cart").load("index.php?route=common/cart/info #cart > *",function(){$("#fastblock > div").html($("#flycart").html()+'<i class="close x"></i>')})},error:function(t,e,c){alert(c+"\r\n"+t.statusText+"\r\n"+t.responseText)}})}},voucher={add:function(){},remove:function(t){$.ajax({url:"index.php?route=checkout/cart/remove",type:"post",data:"key="+t,dataType:"json",beforeSend:function(){},complete:function(){},success:function(t){"checkout/cart"==getURLVar("route")||"checkout/checkout"==getURLVar("route")?location="index.php?route=checkout/cart":$("#cart").load("index.php?route=common/cart/info #cart > *")},error:function(t,e,c){alert(c+"\r\n"+t.statusText+"\r\n"+t.responseText)}})}},wishlist={add:function(t){$.ajax({url:"index.php?route=account/wishlist/add",type:"post",data:"product_id="+t,dataType:"json",success:function(t){$(".alert").remove(),t.redirect&&(location=t.redirect),t.success&&($("#fastblock").html(t.success),ShowImage(),$("#wishlist-total").html(t.total),setTimeout(function(){$("#fastblock .close").click()},3e3))},error:function(t,e,c){alert(c+"\r\n"+t.statusText+"\r\n"+t.responseText)}})},remove:function(){}},compare={add:function(t){$.ajax({url:"index.php?route=product/compare/add",type:"post",data:"product_id="+t,dataType:"json",success:function(t){$(".alert").remove(),t.success&&($("#fastblock").html(t.success),ShowImage(),$("#compare-total").html(t.total),setTimeout(function(){$("#fastblock .close").click()},2200))},error:function(t,e,c){alert(c+"\r\n"+t.statusText+"\r\n"+t.responseText)}})},remove:function(){}};function quickview(t){$("#loading").css({display:"block"}),$("#fastblock").load(t+" #product",function(){ShowImage(),$("#fastblock > div").css({"max-width":"1100px"}).find("#reviews-box").remove()})}$(document).on("click","#fastblock .thumbnails .images > div + div img",function(){var t=$("#fastblock .thumbnails .images > div:first-child img"),e=$(this),c=$(t).attr("src"),o=$(this).attr("src");$(t).attr("src",o),$(e).attr("src",c)});